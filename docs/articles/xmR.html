<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using xmr() and xmr_chart() • xmrr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Using xmr() and xmr_chart()">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xmrr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/xmR.html">Using xmr() and xmr_chart()</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using xmr() and xmr_chart()</h1>
            
      
      
      <div class="hidden name"><code>xmR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>XMR control charts are useful when determining if there are significant trends in data. XMR charts have two key assumptions: one is that the measurements of value happen over time, and the other is that each measurement of time has exactly one measurement of value.</p>
<p>Take careful thought about <em>what</em> you are trying to measure with XMR. Proportions work great, headcount is okay, costs over time don’t work well.</p>
<hr>
</div>
<div id="arguments" class="section level1">
<h1 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h1>
<p>The arguments for <code><a href="../reference/xmr.html">xmr()</a></code> are:</p>
<ul>
<li><p><strong>df</strong>: The dataframe containing the time-series data.</p></li>
<li><p><strong>measure</strong>: The column containing the measure. This must be in a numeric format.</p></li>
<li><p><strong>interval</strong>: The interval you’d like to use to calculate the averages. Defaults to 5.</p></li>
<li><p><strong>recalc</strong>: Logical if you’d like it to recalculate bounds. Defaults to False for safety.</p></li>
<li><p><strong>reuse</strong>: Logical: Should points be re-used in calculations? Defaults to False.</p></li>
<li><p><strong>longrun</strong>: A vector of 2 to determine the rules for a long run. The first point is the ‘n’ of points used to calculate the new reference lines, and the second is to determine how many consecutive points are needed to define a longrun. Default is c(5,8) which uses the first 5 points of a run of 8 to recalculate the bounds.</p></li>
<li><p><strong>shortrun</strong>: A vector of 2 to determine the rules for a short run. The first point is the minimum number of points within the set to qualify a shortrun, and the second is the length of a possible set. Default is c(3,4) which states that 3 of 4 consecutive points need to pass the test to be used in a calculation.</p></li>
</ul>
<p>The data required for XMR charts take a specific format, with at least two columns of data - one for the time variable and another for the measurement.</p>
<p>Like so:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Time</th>
<th align="center">Measure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2000</td>
<td align="center">54</td>
</tr>
<tr class="even">
<td align="center">2001</td>
<td align="center">56</td>
</tr>
<tr class="odd">
<td align="center">2002</td>
<td align="center">59</td>
</tr>
<tr class="even">
<td align="center">2003</td>
<td align="center">65</td>
</tr>
<tr class="odd">
<td align="center">2004</td>
<td align="center">53</td>
</tr>
<tr class="even">
<td align="center">2005</td>
<td align="center">64</td>
</tr>
<tr class="odd">
<td align="center">2006</td>
<td align="center">65</td>
</tr>
<tr class="even">
<td align="center">2007</td>
<td align="center">61</td>
</tr>
<tr class="odd">
<td align="center">2008</td>
<td align="center">60</td>
</tr>
<tr class="even">
<td align="center">2009</td>
<td align="center">51</td>
</tr>
<tr class="odd">
<td align="center">2010</td>
<td align="center">53</td>
</tr>
<tr class="even">
<td align="center">2011</td>
<td align="center">53</td>
</tr>
<tr class="odd">
<td align="center">2012</td>
<td align="center">80</td>
</tr>
<tr class="even">
<td align="center">2013</td>
<td align="center">76</td>
</tr>
<tr class="odd">
<td align="center">2014</td>
<td align="center">82</td>
</tr>
<tr class="even">
<td align="center">2015</td>
<td align="center">77</td>
</tr>
<tr class="odd">
<td align="center">2016</td>
<td align="center">81</td>
</tr>
<tr class="even">
<td align="center">2017</td>
<td align="center">85</td>
</tr>
</tbody>
</table>
<p>If we wanted to use <code><a href="../reference/xmr.html">xmr()</a></code> on this data would be written like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xmr_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xmr.html">xmr</a></span>(<span class="dt">df =</span> example_data, <span class="dt">measure =</span> <span class="st">"Measure"</span>)</code></pre></div>
<p>And if we wanted the bounds to recalculate, we’d use this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xmr_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xmr.html">xmr</a></span>(<span class="dt">df =</span> example_data, <span class="dt">measure =</span> <span class="st">"Measure"</span>, <span class="dt">recalc =</span> T)</code></pre></div>
<p>Output data looks like this:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="5%">
<col width="7%">
<col width="11%">
<col width="11%">
<col width="17%">
<col width="23%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="center">Time</th>
<th align="center">Measure</th>
<th align="center">Central Line</th>
<th align="center">Moving Range</th>
<th align="center">Average Moving Range</th>
<th align="center">Lower Natural Process Limit</th>
<th align="center">Upper Natural Process Limit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2000</td>
<td align="center">54</td>
<td align="center">57.400</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">2001</td>
<td align="center">56</td>
<td align="center">57.400</td>
<td align="center">2</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="odd">
<td align="center">2002</td>
<td align="center">59</td>
<td align="center">57.400</td>
<td align="center">3</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="even">
<td align="center">2003</td>
<td align="center">65</td>
<td align="center">57.400</td>
<td align="center">6</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="odd">
<td align="center">2004</td>
<td align="center">53</td>
<td align="center">57.400</td>
<td align="center">12</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="even">
<td align="center">2005</td>
<td align="center">64</td>
<td align="center">57.400</td>
<td align="center">11</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="odd">
<td align="center">2006</td>
<td align="center">65</td>
<td align="center">57.400</td>
<td align="center">1</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="even">
<td align="center">2007</td>
<td align="center">61</td>
<td align="center">57.400</td>
<td align="center">4</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="odd">
<td align="center">2008</td>
<td align="center">60</td>
<td align="center">57.400</td>
<td align="center">1</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="even">
<td align="center">2009</td>
<td align="center">51</td>
<td align="center">57.400</td>
<td align="center">9</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="odd">
<td align="center">2010</td>
<td align="center">53</td>
<td align="center">57.400</td>
<td align="center">2</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="even">
<td align="center">2011</td>
<td align="center">53</td>
<td align="center">57.400</td>
<td align="center">0</td>
<td align="center">5.750</td>
<td align="center">42.105</td>
<td align="center">72.695</td>
</tr>
<tr class="odd">
<td align="center">2012</td>
<td align="center">80</td>
<td align="center">79.333</td>
<td align="center">27</td>
<td align="center">12.333</td>
<td align="center">46.527</td>
<td align="center">112.140</td>
</tr>
<tr class="even">
<td align="center">2013</td>
<td align="center">76</td>
<td align="center">79.333</td>
<td align="center">4</td>
<td align="center">12.333</td>
<td align="center">46.527</td>
<td align="center">112.140</td>
</tr>
<tr class="odd">
<td align="center">2014</td>
<td align="center">82</td>
<td align="center">79.333</td>
<td align="center">6</td>
<td align="center">12.333</td>
<td align="center">46.527</td>
<td align="center">112.140</td>
</tr>
<tr class="even">
<td align="center">2015</td>
<td align="center">77</td>
<td align="center">79.333</td>
<td align="center">5</td>
<td align="center">12.333</td>
<td align="center">46.527</td>
<td align="center">112.140</td>
</tr>
<tr class="odd">
<td align="center">2016</td>
<td align="center">81</td>
<td align="center">79.333</td>
<td align="center">4</td>
<td align="center">12.333</td>
<td align="center">46.527</td>
<td align="center">112.140</td>
</tr>
<tr class="even">
<td align="center">2017</td>
<td align="center">85</td>
<td align="center">79.333</td>
<td align="center">4</td>
<td align="center">12.333</td>
<td align="center">46.527</td>
<td align="center">112.140</td>
</tr>
</tbody>
</table>
<p>The only mandatory arguments are <strong>df</strong>, because the function needs to operate on a dataframe, and <strong>measure</strong> because the function needs to be told which column contains the measurements. Everything else has been set to what I believe is a safe and sensible default.</p>
<p>In our shop, we typically run the following rules. Since they are the default, there is no need to specify them directly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xmr_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xmr.html">xmr</a></span>(example_data,  <span class="st">"Measure"</span>, 
                <span class="dt">recalc =</span> T,
                <span class="dt">interval =</span> <span class="dv">5</span>,
                <span class="dt">shortrun =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>),
                <span class="dt">longrun =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">8</span>))</code></pre></div>
<p>Feel free to play around with your own definitions of what a shortrun or longrun is.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xmr_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xmr.html">xmr</a></span>(<span class="dt">df =</span> example_data, 
                <span class="dt">measure =</span> <span class="st">"Measure"</span>, 
                <span class="dt">recalc =</span> T,
                <span class="co">#change the rule like so:,</span>
                <span class="dt">interval =</span> <span class="dv">4</span>,
                <span class="dt">shortrun =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</code></pre></div>
<p>The statistical differences between rules are slight, but each user will have different needs and it’s useful to be able to tune the function to those needs.</p>
<p>It is important to use a consistent definition of what a long/short run are. It wouldn’t be appropriate in one report to use one set of definitions for one dataset, and another set for a different dataset.</p>
<hr>
</div>
<div id="charts" class="section level1">
<h1 class="hasAnchor">
<a href="#charts" class="anchor"></a>Charts</h1>
<p>The <code><a href="../reference/xmr.html">xmr()</a></code> function is handy for generating chart data as the output can be saved and used in other applications. But what about visualization within R?</p>
<p><code><a href="../reference/xmr_chart.html">xmr_chart()</a></code> takes the output from <code><a href="../reference/xmr.html">xmr()</a></code> and generates a ggplot graphic. This works well for reporting, but it also works great for quick diagnostics of your data.</p>
<p>The arguments for <code><a href="../reference/xmr_chart.html">xmr_chart()</a></code> are:</p>
<ul>
<li><p><strong>df</strong>: Output from xmr()</p></li>
<li><p><strong>time</strong>: The column containing the time variable for the x-axis.</p></li>
<li><p><strong>measure</strong>: The column containing the measure for the y-axis.</p></li>
<li><p><strong>boundary_linetype</strong>: Type of line for upper and lower boundary lines. Defaults to “dashed”.</p></li>
<li><p><strong>central_linetype</strong>: Type of line for central line. Defaults to “dotted”.</p></li>
<li><p><strong>boundary_colour</strong>: Colour of line for upper and lower boundary lines. Defaults to “#d02b27”.</p></li>
<li><p><strong>point_colour</strong>: Colour of points. Defaults to “#7ECBB5”.</p></li>
<li><p><strong>point_size</strong>: Size of points. Defaults to 2.</p></li>
<li><p><strong>line_width</strong>: Width of lines. Defaults to 0.5.</p></li>
<li><p><strong>text_size</strong>: Size of chart text. Defaults to 9.</p></li>
</ul>
<p>There are defaults set for most arguments, so all the user <em>needs</em> to supply are the column names for the Time and Measurement column unless they want some slight modification of the default chart.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/xmr_chart.html">xmr_chart</a></span>(<span class="dt">df =</span> xmr_data, 
          <span class="dt">time =</span> <span class="st">"Time"</span>, 
          <span class="dt">measure =</span> <span class="st">"Measure"</span>,
          <span class="dt">line_width =</span> <span class="fl">0.75</span>, <span class="dt">text_size =</span> <span class="dv">12</span>, <span class="dt">point_size =</span> <span class="fl">2.5</span>)</code></pre></div>
<p><img src="xmR_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>A work-flow that I use is to ‘pipe’ the output of <code><a href="../reference/xmr.html">xmr()</a></code> directly into <code><a href="../reference/xmr_chart.html">xmr_chart()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/xmr.html">xmr</a></span>(<span class="st">"Measure"</span>, <span class="dt">recalc =</span> T) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/xmr_chart.html">xmr_chart</a></span>(<span class="st">"Time"</span>, <span class="st">"Measure"</span>)</code></pre></div>
<hr>
</div>
<div id="tidyverse---dplyr-ggplot2" class="section level1">
<h1 class="hasAnchor">
<a href="#tidyverse---dplyr-ggplot2" class="anchor"></a>Tidyverse - dplyr &amp; ggplot2</h1>
<p>Simple datasets like those illustrated above are common, but how could we work with large datasets that have multiple factors?</p>
<p>Consider the following data. How would <code><a href="../reference/xmr.html">xmr()</a></code> benefit the user in this case?</p>
<table class="table">
<thead><tr class="header">
<th align="center">Year</th>
<th align="center">Variable</th>
<th align="center">Measure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2004</td>
<td align="center">A</td>
<td align="center">38</td>
</tr>
<tr class="even">
<td align="center">2005</td>
<td align="center">A</td>
<td align="center">78</td>
</tr>
<tr class="odd">
<td align="center">2006</td>
<td align="center">A</td>
<td align="center">93</td>
</tr>
<tr class="even">
<td align="center">2007</td>
<td align="center">A</td>
<td align="center">21</td>
</tr>
<tr class="odd">
<td align="center">2008</td>
<td align="center">A</td>
<td align="center">65</td>
</tr>
<tr class="even">
<td align="center">2009</td>
<td align="center">A</td>
<td align="center">13</td>
</tr>
<tr class="odd">
<td align="center">2010</td>
<td align="center">A</td>
<td align="center">27</td>
</tr>
<tr class="even">
<td align="center">2011</td>
<td align="center">A</td>
<td align="center">39</td>
</tr>
<tr class="odd">
<td align="center">2012</td>
<td align="center">A</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2013</td>
<td align="center">A</td>
<td align="center">38</td>
</tr>
<tr class="odd">
<td align="center">2014</td>
<td align="center">A</td>
<td align="center">87</td>
</tr>
<tr class="even">
<td align="center">2015</td>
<td align="center">A</td>
<td align="center">34</td>
</tr>
<tr class="odd">
<td align="center">2016</td>
<td align="center">A</td>
<td align="center">48</td>
</tr>
<tr class="even">
<td align="center">2017</td>
<td align="center">A</td>
<td align="center">60</td>
</tr>
<tr class="odd">
<td align="center">2004</td>
<td align="center">B</td>
<td align="center">49</td>
</tr>
<tr class="even">
<td align="center">2005</td>
<td align="center">B</td>
<td align="center">19</td>
</tr>
<tr class="odd">
<td align="center">2006</td>
<td align="center">B</td>
<td align="center">83</td>
</tr>
<tr class="even">
<td align="center">2007</td>
<td align="center">B</td>
<td align="center">67</td>
</tr>
<tr class="odd">
<td align="center">2008</td>
<td align="center">B</td>
<td align="center">79</td>
</tr>
<tr class="even">
<td align="center">2009</td>
<td align="center">B</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="center">2010</td>
<td align="center">B</td>
<td align="center">72</td>
</tr>
<tr class="even">
<td align="center">2011</td>
<td align="center">B</td>
<td align="center">41</td>
</tr>
<tr class="odd">
<td align="center">2012</td>
<td align="center">B</td>
<td align="center">82</td>
</tr>
<tr class="even">
<td align="center">2013</td>
<td align="center">B</td>
<td align="center">65</td>
</tr>
<tr class="odd">
<td align="center">2014</td>
<td align="center">B</td>
<td align="center">78</td>
</tr>
<tr class="even">
<td align="center">2015</td>
<td align="center">B</td>
<td align="center">55</td>
</tr>
<tr class="odd">
<td align="center">2016</td>
<td align="center">B</td>
<td align="center">53</td>
</tr>
<tr class="even">
<td align="center">2017</td>
<td align="center">B</td>
<td align="center">79</td>
</tr>
</tbody>
</table>
<p>The answer is by leveraging other R packages, namely the <code>tidyverse</code>.</p>
<p>You can install and load the tidyverse with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#this installs many useful packages</span>
<span class="kw">install.packages</span>(<span class="st">"tidyverse"</span>)

<span class="co">#this just loads the ones we need</span>
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)</code></pre></div>
<p>With <code>dplyr</code>, we can make use of powerful data-wrangling verbs without writing them into <code>xmrr</code>’s functions specifically:</p>
<ul>
<li>
<code>select()</code>:- picks variables based on their names.</li>
<li>
<code>filter()</code>:- picks cases based on their values.</li>
<li>
<code>arrange()</code>:- changes the ordering of the rows.</li>
<li>
<code>mutate()</code>:- adds new variables that are functions of existing variables.</li>
<li>
<code>summarise()</code>:- reduces multiple values down to a single summary.</li>
<li>
<code>group_by()</code>:- allows for group operations in the “split-apply-combine” concept</li>
</ul>
<p>Also loaded with <code>dplyr</code> is a powerful operator to chain functions together, called a pipe <code>%&gt;%</code>.</p>
<p>With <code>ggplot2</code>, we take a modern approach to visualizing data. An up-to-date reference list of functions can be found <a href="http://ggplot2.tidyverse.org/reference/">here</a></p>
<p>This enables a number of verb-type functions for tidying, wrangling, and plotting data. This is how to use them alongside the <code><a href="../reference/xmr.html">xmr()</a></code> and <code><a href="../reference/xmr_chart.html">xmr_chart()</a></code> functions.</p>
<hr>
</div>
<div id="grouping-and-faceting" class="section level1">
<h1 class="hasAnchor">
<a href="#grouping-and-faceting" class="anchor"></a>Grouping and Faceting</h1>
<p>Take our multiple factor data <code>MFD</code> - here is how to apply the <code><a href="../reference/xmr.html">xmr()</a></code> function to certain groups within that data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MFD_xmr &lt;-<span class="st"> </span>MFD <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Variable) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(<span class="kw"><a href="../reference/xmr.html">xmr</a></span>(., <span class="st">"Measure"</span>, <span class="dt">recalc =</span> T))</code></pre></div>
<p>To obtain the following:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="4%">
<col width="7%">
<col width="6%">
<col width="5%">
<col width="10%">
<col width="10%">
<col width="15%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Year</th>
<th align="center">Variable</th>
<th align="center">Measure</th>
<th align="center">Order</th>
<th align="center">Central Line</th>
<th align="center">Moving Range</th>
<th align="center">Average Moving Range</th>
<th align="center">Lower Natural Process Limit</th>
<th align="center">Upper Natural Process Limit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2004</td>
<td align="center">A</td>
<td align="center">38</td>
<td align="center">1</td>
<td align="center">59.000</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">2005</td>
<td align="center">A</td>
<td align="center">78</td>
<td align="center">2</td>
<td align="center">59.000</td>
<td align="center">40</td>
<td align="center">42.750</td>
<td align="center">0</td>
<td align="center">172.715</td>
</tr>
<tr class="odd">
<td align="center">2006</td>
<td align="center">A</td>
<td align="center">93</td>
<td align="center">3</td>
<td align="center">59.000</td>
<td align="center">15</td>
<td align="center">42.750</td>
<td align="center">0</td>
<td align="center">172.715</td>
</tr>
<tr class="even">
<td align="center">2007</td>
<td align="center">A</td>
<td align="center">21</td>
<td align="center">4</td>
<td align="center">59.000</td>
<td align="center">72</td>
<td align="center">42.750</td>
<td align="center">0</td>
<td align="center">172.715</td>
</tr>
<tr class="odd">
<td align="center">2008</td>
<td align="center">A</td>
<td align="center">65</td>
<td align="center">5</td>
<td align="center">59.000</td>
<td align="center">44</td>
<td align="center">42.750</td>
<td align="center">0</td>
<td align="center">172.715</td>
</tr>
<tr class="even">
<td align="center">2009</td>
<td align="center">A</td>
<td align="center">13</td>
<td align="center">6</td>
<td align="center">13.667</td>
<td align="center">52</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="odd">
<td align="center">2010</td>
<td align="center">A</td>
<td align="center">27</td>
<td align="center">7</td>
<td align="center">13.667</td>
<td align="center">14</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="even">
<td align="center">2011</td>
<td align="center">A</td>
<td align="center">39</td>
<td align="center">8</td>
<td align="center">13.667</td>
<td align="center">12</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="odd">
<td align="center">2012</td>
<td align="center">A</td>
<td align="center">1</td>
<td align="center">9</td>
<td align="center">13.667</td>
<td align="center">38</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="even">
<td align="center">2013</td>
<td align="center">A</td>
<td align="center">38</td>
<td align="center">10</td>
<td align="center">13.667</td>
<td align="center">37</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="odd">
<td align="center">2014</td>
<td align="center">A</td>
<td align="center">87</td>
<td align="center">11</td>
<td align="center">13.667</td>
<td align="center">49</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="even">
<td align="center">2015</td>
<td align="center">A</td>
<td align="center">34</td>
<td align="center">12</td>
<td align="center">13.667</td>
<td align="center">53</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="odd">
<td align="center">2016</td>
<td align="center">A</td>
<td align="center">48</td>
<td align="center">13</td>
<td align="center">13.667</td>
<td align="center">14</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="even">
<td align="center">2017</td>
<td align="center">A</td>
<td align="center">60</td>
<td align="center">14</td>
<td align="center">13.667</td>
<td align="center">12</td>
<td align="center">34.667</td>
<td align="center">0</td>
<td align="center">105.880</td>
</tr>
<tr class="odd">
<td align="center">2004</td>
<td align="center">B</td>
<td align="center">49</td>
<td align="center">1</td>
<td align="center">59.400</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">2005</td>
<td align="center">B</td>
<td align="center">19</td>
<td align="center">2</td>
<td align="center">59.400</td>
<td align="center">30</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="odd">
<td align="center">2006</td>
<td align="center">B</td>
<td align="center">83</td>
<td align="center">3</td>
<td align="center">59.400</td>
<td align="center">64</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="even">
<td align="center">2007</td>
<td align="center">B</td>
<td align="center">67</td>
<td align="center">4</td>
<td align="center">59.400</td>
<td align="center">16</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="odd">
<td align="center">2008</td>
<td align="center">B</td>
<td align="center">79</td>
<td align="center">5</td>
<td align="center">59.400</td>
<td align="center">12</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="even">
<td align="center">2009</td>
<td align="center">B</td>
<td align="center">11</td>
<td align="center">6</td>
<td align="center">59.400</td>
<td align="center">68</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="odd">
<td align="center">2010</td>
<td align="center">B</td>
<td align="center">72</td>
<td align="center">7</td>
<td align="center">59.400</td>
<td align="center">61</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="even">
<td align="center">2011</td>
<td align="center">B</td>
<td align="center">41</td>
<td align="center">8</td>
<td align="center">59.400</td>
<td align="center">31</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="odd">
<td align="center">2012</td>
<td align="center">B</td>
<td align="center">82</td>
<td align="center">9</td>
<td align="center">59.400</td>
<td align="center">41</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="even">
<td align="center">2013</td>
<td align="center">B</td>
<td align="center">65</td>
<td align="center">10</td>
<td align="center">59.400</td>
<td align="center">17</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="odd">
<td align="center">2014</td>
<td align="center">B</td>
<td align="center">78</td>
<td align="center">11</td>
<td align="center">59.400</td>
<td align="center">13</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="even">
<td align="center">2015</td>
<td align="center">B</td>
<td align="center">55</td>
<td align="center">12</td>
<td align="center">59.400</td>
<td align="center">23</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="odd">
<td align="center">2016</td>
<td align="center">B</td>
<td align="center">53</td>
<td align="center">13</td>
<td align="center">59.400</td>
<td align="center">2</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
<tr class="even">
<td align="center">2017</td>
<td align="center">B</td>
<td align="center">79</td>
<td align="center">14</td>
<td align="center">59.400</td>
<td align="center">26</td>
<td align="center">30.500</td>
<td align="center">0</td>
<td align="center">140.530</td>
</tr>
</tbody>
</table>
<p>And as you may be able to see in the data, the <code><a href="../reference/xmr.html">xmr()</a></code> calculated on Measure <strong>BY</strong> Variable in one chained function instead of having to manually split the data and run the function multiple times. This is possible with an arbitrary number of factors, and leverages the speed of <code>dplyr</code> verbs.</p>
<p>Similarly, <code>ggplot2</code> can be leveraged in plotting. Note that since <code><a href="../reference/xmr_chart.html">xmr_chart()</a></code> outputs a ggplot object, we can apply the regular ggplot2 functions to it and return a faceted chart rather than filtering the chart and making two.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MFD <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Variable) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(<span class="kw"><a href="../reference/xmr.html">xmr</a></span>(., <span class="st">"Measure"</span>, <span class="dt">recalc =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/xmr_chart.html">xmr_chart</a></span>(<span class="st">"Year"</span>, <span class="st">"Measure"</span>, <span class="dt">line_width =</span> <span class="fl">0.75</span>, <span class="dt">text_size =</span> <span class="dv">12</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Variable) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2017</span>, <span class="dv">4</span>))</code></pre></div>
<p><img src="xmR_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#charts">Charts</a></li>
      <li><a href="#tidyverse---dplyr-ggplot2">Tidyverse - dplyr &amp; ggplot2</a></li>
      <li><a href="#grouping-and-faceting">Grouping and Faceting</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alex Zanidean.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
